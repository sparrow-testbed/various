<?xml version="1.0" encoding="EUC-KR" ?>
<service>
	<method name="insertSinfhdInfo">
		INSERT INTO SINFHD(
			HOUSE_CODE,     INF_NO,       INF_TYPE,   INF_CODE,   INF_DATE,
			INF_START_TIME, INF_END_TIME, INF_STATUS, INF_REASON, INF_SEND
		)
		VALUES(
			${HOUSE_CODE},
			${INF_NO},
			${INF_TYPE},
			${INF_CODE},
			TO_CHAR(SYSDATE, 'YYYYMMDD'),
			
			TO_CHAR(SYSDATE, 'HH24MISS'),
			NULL,
			NULL,
			NULL,
			${INF_SEND}
		)
	</method>
	
	<method name="updateSinfhdInfo">
		UPDATE
			SINFHD
		SET
			INF_END_TIME = TO_CHAR(SYSDATE, 'HH24MISS'),
			INF_STATUS   = ${STATUS},
			INF_REASON   = ${REASON}
		WHERE
			HOUSE_CODE = ${HOUSE_CODE}
		AND
			INF_NO     = ${INF_NO}
	</method>
	
	<method name="insertSinfmailInfo">
		INSERT INTO SINFMAIL (
			HOUSE_CODE,    INF_NO, SENDERADDR, SUBJECT, CONTENT,
			RECIPIENTSADDR
		)
		VALUES(
			${HOUSE_CODE},
			${INF_NO},
			${SENDERADDR},
			${SUBJECT},
			${CONTENT},
			${RECIPIENTSADDR}
		)
	</method>
	
	<method name="selectIcoyrqdtPurchaserEmailVendorNameEmailList">
		SELECT DISTINCT
			PADD.EMAIL,
			GETVENDORNAME(RQSE.HOUSE_CODE, RQSE.VENDOR_CODE) AS VENDOR_NAME,
			VADD.EMAIL                                       AS VENDOR_EMAIL
		FROM
			ICOYRQDT RQDT
		INNER JOIN ICOYPRDT PRDT ON RQDT.HOUSE_CODE = PRDT.HOUSE_CODE AND RQDT.PR_NO        = PRDT.PR_NO   AND RQDT.PR_SEQ    = PRDT.PR_SEQ
		INNER JOIN ICOMADDR PADD ON PRDT.HOUSE_CODE = PADD.HOUSE_CODE AND PRDT.PURCHASER_ID = PADD.CODE_NO
		INNER JOIN ICOYRQSE RQSE ON RQDT.HOUSE_CODE = RQSE.HOUSE_CODE AND RQDT.RFQ_NO       = RQSE.RFQ_NO  AND RQDT.RFQ_COUNT = RQSE.RFQ_COUNT AND RQDT.RFQ_SEQ = RQSE.RFQ_SEQ
		INNER JOIN ICOMADDR VADD ON RQSE.HOUSE_CODE = VADD.HOUSE_CODE AND RQSE.VENDOR_CODE  = VADD.CODE_NO
		WHERE
			RQDT.HOUSE_CODE = ${HOUSE_CODE}
		AND   
			RQDT.RFQ_NO     = ${RFQ_NO}
		AND   
			RQDT.RFQ_COUNT  = ${RFQ_COUNT}
		AND   
			PADD.CODE_TYPE  = '3'
		AND   
			VADD.CODE_TYPE  = '2'
		ORDER BY
			PADD.EMAIL
	</method>
	
	<method name="selectRg1List">
		SELECT
			VNGL.VENDOR_NAME_LOC,
			ADDR.EMAIL
		FROM
			ICOMVNGL VNGL
		INNER JOIN ICOMADDR ADDR ON VNGL.HOUSE_CODE = ADDR.HOUSE_CODE AND VNGL.VENDOR_CODE = ADDR.CODE_NO
		WHERE
			VNGL.HOUSE_CODE  = ${HOUSE_CODE}
		AND
			VNGL.VENDOR_CODE = ${VENDOR_CODE}
		AND
			ADDR.CODE_TYPE   = '2'
	</method>
	
	<method name="selectIv1List">
		SELECT
			IVHD.SUBJECT,
			VNGL.VENDOR_NAME_LOC,
			ADDR.EMAIL
		FROM
			ICOYIVHD IVHD
		INNER JOIN ICOMADDR ADDR ON IVHD.HOUSE_CODE = ADDR.HOUSE_CODE AND IVHD.VENDOR_CODE = ADDR.CODE_NO
		INNER JOIN ICOMVNGL VNGL ON IVHD.HOUSE_CODE = VNGL.HOUSE_CODE AND IVHD.VENDOR_CODE = VNGL.VENDOR_CODE
		WHERE
			IVHD.HOUSE_CODE = ${HOUSE_CODE}
		AND
			IVHD.INV_NO     = ${INV_NO}
		AND
			ADDR.CODE_TYPE  = '2'
	</method>
	
	<method name="selectRq2List">
		SELECT
			RQHD.RFQ_TYPE,
			RQHD.SUBJECT,
			VNGL.VENDOR_NAME_LOC,
			ADDR.EMAIL
		FROM
			ICOYRQHD        RQHD
		INNER JOIN ICOYRQSE RQSE ON RQHD.HOUSE_CODE = RQSE.HOUSE_CODE AND RQHD.RFQ_NO      = RQSE.RFQ_NO      AND RQHD.RFQ_COUNT = RQSE.RFQ_COUNT
		INNER JOIN ICOMVNGL VNGL ON RQSE.HOUSE_CODE = VNGL.HOUSE_CODE AND RQSE.VENDOR_CODE = VNGL.VENDOR_CODE
		INNER JOIN ICOMADDR ADDR ON VNGL.HOUSE_CODE = ADDR.HOUSE_CODE AND VNGL.VENDOR_CODE = ADDR.CODE_NO
		WHERE
			RQSE.HOUSE_CODE = ${HOUSE_CODE}
		AND
			RQHD.RFQ_NO     = ${RFQ_NO}
		AND
			RQHD.RFQ_COUNT  = ${RFQ_COUNT}
		AND
			ADDR.CODE_TYPE  = '2'
	</method>
</service>