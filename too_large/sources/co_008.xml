<?xml version="1.0" encoding="EUC-KR" ?>
<service>
	<method name="selectUserList">
		SELECT
			USR.USER_ID,
			USR.USER_NAME_LOC,
			OGDP.DEPT_NAME_LOC, 
			(
				CASE
					USR.USER_TYPE
				WHEN 'S' THEN
					GETICOMCODE2(USR.HOUSE_CODE,'M106',USR.POSITION)
				WHEN 'LIGS' THEN
					GETICORCODE2(USR.HOUSE_CODE, USR.COMPANY_CODE, 'C002', USR.POSITION)
				ELSE
					GETICORCODE2(USR.HOUSE_CODE, USR.COMPANY_CODE,'C002',USR.POSITION)
				END
			)   AS  POSITION,
			(
				CASE
					USR.USER_TYPE                                                                                      
				WHEN 'S' THEN
					GETICOMCODE2(USR.HOUSE_CODE,'M107',USR.MANAGER_POSITION)               
				WHEN 'IBKS' THEN
					GETICOMCODE2(USR.HOUSE_CODE,'M107',USR.MANAGER_POSITION)               
				ELSE
					GETICORCODE2(USR.HOUSE_CODE,USR.COMPANY_CODE,'C001',USR.MANAGER_POSITION)        
				END
			) AS MANAGER_POSITION,
			USR.POSITION AS POSITION_CD,
			USR.MANAGER_POSITION AS MANAGER_POSITION_CD 
		FROM
			ICOMLUSR USR
		LEFT OUTER JOIN ICOMOGDP OGDP ON USR.HOUSE_CODE = OGDP.HOUSE_CODE AND USR.DEPT = OGDP.DEPT
		WHERE
			USR.HOUSE_CODE   = ${HOUSE_CODE} 
		AND
			USR.COMPANY_CODE = ${COMPANY_CODE} 
		AND UPPER(USR.USER_ID) LIKE UPPER('%' || $S{USER_ID} || '%')  
		AND USR.USER_NAME_LOC LIKE '%' || $S{USER_NAME_LOC} || '%'
		AND OGDP.DEPT LIKE '%' || $S{deptCd} || '%' 
		AND OGDP.DEPT_NAME_LOC LIKE '%' || $S{deptNm} || '%'  
		AND
			USR.STATUS IN ('C', 'R')
		ORDER BY
			USER_ID
	</method>
	
	<method name="selectApprovalUserList_bak20220822">
	    <![CDATA[
		SELECT
			USR.USER_ID,
			USR.USER_NAME_LOC,
			OGDP.DEPT_NAME_LOC, 
			USR.POSITION AS POSITION_CD 
		FROM
			ICOMLUSR USR
		LEFT OUTER JOIN ICOMOGDP OGDP ON USR.HOUSE_CODE = OGDP.HOUSE_CODE AND USR.DEPT = OGDP.DEPT
		WHERE USR.HOUSE_CODE   = ${HOUSE_CODE} 
		AND USR.COMPANY_CODE = ${COMPANY_CODE} 
		AND UPPER(USR.USER_ID) LIKE UPPER('%' || $S{USER_ID} || '%')  
		AND USR.USER_NAME_LOC LIKE '%' || $S{USER_NAME_LOC} || '%'
		AND OGDP.DEPT LIKE '%' || $S{deptCd} || '%' 
		AND OGDP.DEPT_NAME_LOC LIKE '%' || $S{deptNm} || '%'  
		AND USR.STATUS IN ('C', 'R')
		AND USR.POSITION < '220000'
		AND USR.DEL_FLAG <> 'Y'
		AND REGEXP_INSTR(USR.USER_ID,'[^0-9]') = 0
		ORDER BY USR.POSITION
		]]>
	</method>
	
	<method name="selectApprovalUserList">
	    <![CDATA[
		SELECT
			USR.USER_ID,
			USR.USER_NAME_LOC,
			OGDP.DEPT_NAME_LOC, 
			USR.POSITION AS POSITION_CD 
		FROM
			ICOMLUSR USR
		LEFT OUTER JOIN ICOMOGDP OGDP ON USR.HOUSE_CODE = OGDP.HOUSE_CODE AND USR.DEPT = OGDP.DEPT
		WHERE USR.HOUSE_CODE   = ${HOUSE_CODE} 
		AND USR.COMPANY_CODE = ${COMPANY_CODE} 
		AND OGDP.DEPT = ${deptCd}
		AND USR.STATUS <> 'D'
		AND USR.POSITION BETWEEN '070000' AND  '219360'        
		AND USR.DEL_FLAG <> 'Y'
		AND REGEXP_INSTR(USR.USER_ID,'[^0-9]') = 0
		ORDER BY USR.POSITION
		]]>
	</method>
</service>